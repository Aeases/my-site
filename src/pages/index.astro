---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import FormattedDate from '../components/FormattedDate.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const projects = (await getCollection('projects')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
        <style>
        .layout-grid-container {
            display: grid;
            justify-items: center;
        }


        .blogs > p 

        .post-card {
            cursor: wait;
            margin-right: auto;
            margin-left: auto;
        }
        ul:has(.post-card) {	
            /*The ul should take up the whole parent, it has li's that are smaller inside. */
            display: grid;
            grid-template-columns: 1fr;
            justify-content: space-around;
            justify-items: center;
            gap: 0.5em;
        }


        .post-card {
            display: grid;
            padding: 1rem;
            /* 	background-color: var(--color-bg-secondary); */
            grid-template-columns: 1fr 1fr;	
            border-radius: var(--radius-card);
            /* 	border: var(--border-card);
border-style: dotted;	 */
            gap: 0.5em 0.75em;

            & .post-image {
                grid-area: image;
                object-fit: cover;
                border-radius: var(--radius-univ);
                aspect-ratio: 1/1;
            }
            & .post-textcontent {
                grid-area: textcontent;
                display: grid;
                align-content: center;
                color: inherit;
                -webkit-font-smoothing: antialiased;
                font-weight: 500;
                .title {
                    font-family: var(--fancy-title-fonts);
                    font-size: 56px;
                    line-height: 1.05em;
                }
                .date {
                    font-family: 'SourceCodePro';
                    color: var(--color-tx-muted);
                }

            }
        }

        li {
            &:nth-child(even) > .post-card {
                grid-template-areas: 'textcontent image';
                text-align: right;
            }		
            &:nth-child(odd) > .post-card {
                grid-template-areas: 'image textcontent';
                text-align: left;
            }
        }
        </style>
    </head>
    <body class="theme-dark">
        <Header title={SITE_TITLE} />
        <main class="layout-grid-container">
            <div class="projects">
                <ul>
                    {
                    projects.filter(p => p.data.private !== true).map((prj) => (
                    <li>	
                        <a href={`/${prj.slug}/`} class="post-card">
                            <Image class="post-image" width={720} height={720} src={prj.data.heroImage} alt="" />
                            <div class="post-textcontent">
                                <header class="title">{prj.data.title}</header>
                                <p class="date">
                                    <FormattedDate date={prj.data.pubDate} />
                                </p>
                            </div>
                        </a>
                    </li>

                    ))
                    }

                </ul>
            </div>
        </main>
        <Footer />
</html>
