---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import FormattedDate from '../components/FormattedDate.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const projects = (await getCollection('projects')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const posts = (await getCollection('posts')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
    <head>
        <BaseHead title="Updates" description={SITE_DESCRIPTION} />
        <style>
        .layout-grid-container {
            display: grid;
            justify-items: center;
        }



        .post-item {
            &:hover {
                color: var(--color-bl)
            }
            .date {
                color: var(--color-tx-muted);
                font-family: var(--date-fonts);
            }
            .title {
                margin: 0 0 0.1em;
                line-height: 1.2;
                font-family: var(--fancy-title-fonts);
                text-decoration: underline;
                text-underline-offset: 2px;
                margin-right: 2rem;
            }
        }

        .project-card {
            display: grid;
            padding: 1rem;
            grid-template-columns: 1fr 1fr;	
            border-radius: var(--radius-card);
            gap: 0.5em 0.75em;

            .project-image {
                grid-area: image;
                object-fit: cover;
                border-radius: var(--radius-univ);
                aspect-ratio: 1/1;
            }
            .project-textcontent {
                grid-area: textcontent;
                display: grid;
                align-content: center;
                color: inherit;
                -webkit-font-smoothing: antialiased;
                font-weight: 500;
                .title {
                    font-family: var(--fancy-title-fonts);
                    font-size: 56px;
                    line-height: 1.05em;
                }
                .date {
                    font-family: 'SourceCodePro';
                    color: var(--color-tx-muted);
                }

            }
        }

        li {
            &:nth-child(even) > .project-card {
                grid-template-areas: 'textcontent image';
                text-align: right;
            }		
            &:nth-child(odd) > .project-card {
                grid-template-areas: 'image textcontent';
                text-align: left;
            }
        }
        </style>
    </head>
    <body class="theme-dark">
        <Header title={SITE_TITLE} />
        <main class="layout-grid-container">



            <div class="updates">
                <ul>
                    {
                    posts.filter(p => p.data.private !== true).map((post) => (
                            <li>
                                <a class="post-item" href={`/${post.slug}/`}>
                                    <span class="date">{<FormattedDate date={post.data.pubDate} />}</span>
                                    <span class="title">{post.data.title}</span>
                                </a>

                            </li>
                        ))
                        
                    }
                </ul>

            </div>

            <div class="projects">
                <ul>
                    {
                    projects.filter(p => p.data.private !== true).map((prj) => (
                    <li>	
                        <a href={`/${prj.slug}/`} class="project-card">
                            <Image class="project-image" width={720} height={720} src={prj.data.heroImage} alt="" />
                            <div class="project-textcontent">
                                <header class="title">{prj.data.title}</header>
                                <p class="date">
                                    <FormattedDate date={prj.data.pubDate} />
                                </p>
                            </div>
                        </a>
                    </li>

                    ))
                    }

                </ul>
            </div>
        </main>
        <Footer />
</html>
